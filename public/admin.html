<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Share</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico" type="image/gif" sizes="16x16">
</head>

<body>
    <div class="cardInicial">
        <div>
            <h1>
                Welcome to Movie Share!
            </h1>
            <p>
                Watching movies with your friends never was too easy
            </p>
            <button onclick="show()">
                Ssssssh!
            </button>
        </div>
    </div>

    <video controls>
        <source src="https://dl.dropboxusercontent.com/s/9mvqo6ga3jzhh07/Um.Lugar.Silencioso.2018.1080p.WEB-DL.6CH..x264.DUAL-WWW.COMANDOTORRENTS.COM.mkv?dl=0" type="video/mp4">
        Seu navegador n√£o suporta o elemento <code>video</code>.
    </video>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"
        integrity="sha512-v8ng/uGxkge3d1IJuEo6dJP8JViyvms0cly9pnbfRxT6/31c3dRWxIiwGnMSWwZjHKOuY3EVmijs7k1jz/9bLA=="
        crossorigin="anonymous"></script>
    <script>
        const video = document.querySelector('video')
        const socket = io()

        video.addEventListener('play', () => {
            const seconds = video.currentTime
            socket.emit('action', 'goTo', seconds)
            socket.emit('action', 'play')
        })

        video.addEventListener('pause', () => {
            const seconds = video.currentTime
            socket.emit('action', 'goTo', seconds)
            socket.emit('action', 'pause')
        })

        video.addEventListener('seeked', () => {
            const seconds = video.currentTime
            socket.emit('action', 'goTo', seconds)
        })

        function show() {
            video.style.display = 'block'
            document.querySelector('.cardInicial').style.display = 'none'
        }

        socket.on('broadcast', (action) => {
            if (action === 'sincronize') {
                const seconds = video.currentTime
                socket.emit('action', 'goTo', seconds)
            }
        })
    </script>
</body>

</html>